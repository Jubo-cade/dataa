 /*
1. js-?? ?????????? ???????????? ?????? ????? movies ???????? ???????? ???????????. 
?????? ?????? html ????????? ????????? html ?????? ????????????
2. ???????????? ???????? ????? ?????? ????????, ????? ?????? ???????. 
??? ?? ??????? ????? ????????? ?????? ???????? ?????? ??????? ?? ??????? ?? ???? ?????????.
3. ?????????? ??????? ??????? ??????? ???????? ?????????

?????????:
??????? ????? ????? ???? ???? ?????????? js-??. 
??????? ??????? ????????? ?? ??????? ??????? ??????? ???????? ??? ???? ????????? ??????? ??????? 
??????? ????????

?????????? ?????? ??????????: ???????? ????????? event.preventDefault()

????????? ???? ?????? ??????? ???????????? ??????
*/


'use strict';
class MoviePortal{
	moviesList = document.getElementById('moviesList');
	totalFound = document.getElementById('totalFound');
	movies = [
	   {
	      "name":"???????? ??????",
	      "genre":"?????",
	      "poster":"images/img_1.jpg",
	      "desc":"????? ??????????? ?.???? ??????????? ????? ???????????? ??????? ????????????. <br>??????? ??? ?????? ?????????? ????? – ????? ?????????? ??? ??????????? ?? ??, ??? ???? ??????,<br???????? ???? ???????????? ??????, ????? ?????????? ????-???????? ?? ???????? ????? ???????????? ?????????? ???????, ???? ????????? ?????????? ???? ????? ??????????."
	   },
	   {
	      "name":"????? ????? ??????",
	      "poster":"images/img_2.jpg",
	      "genre":"?????",
	      "desc":"????? \"?????? ????? ?????\" ??????????? ???????? ?????? ??????????? ??? ????????? ???????, <br>???????? ????????????? ?????????????? ?? ??????????? ???????????? ???????. ???????,<br>???????? ??????, ???????? ???????? ?? ?????????????? ???????. ???????? ??????? ???????????? ??????????, ??? ???????? ????????? ???????????..."
	   },
	   {
	      "name":"?????? 007: ????? ???????? ?? ?????",
	      "poster":"images/img_3.jpg",
	      "genre":"?????-??????????",
	      "desc":"???????????, ??????????, ??????? ????????, ????????????????? ????????? - <br>?? ????????? MI6-?? ??????????? ???????, ????? ?????? ??? ??????? ?????? ??????????.<br????? ?????? ?????????????? ????????? ????????? ??????? ????? ??????? ????????????? ???? ???????."
	   },
	   {
	      "name":"???? ??????",
	      "poster":"images/img_4.jpg",
	      "genre":"?????-??????????",
	      "desc":"??????? ?????????? ??????????? ??????? ??????? ????? ?????. <br>????????? ??? ????????? ?? ???????? ????? ??????? ????? ??? ??????? ??????? ??????? ??????????? ???????????? ?????? ??????????. <br>??????????? ??????? ????????? ??????? ???????, ?????,?????? ???? ????? ?????? ?? ????????????. <br>?? ????? ??????? ?????????, ????? ???????? ???????????? ?????? ??????????."
	   }
	];
	getMoviesList(moviesArray = this.movies){
		  let allMoviesList = moviesArray.map(movie =>`<div class="col-lg-6 col-xl-3 d-flex flex-column justify-content-end movie-preview">
                   <div class="row">
                      <div class="col-sm-6 col-lg-12">
                        <img src=" ${movie.poster}" alt="poster" class="img-fluid movie-poster">
                      </div>
                      <div class="col-sm-6 col-lg-12"> 
                        <h4 class="mt-5"> ${movie.name}</h4>
                        <p class="movie-preview-text">
                          ${movie.desc}
                        </p>
                        <p><b>?????: </b><span><a href="#">${movie.genre}</a></span></p>
                        <button type="button" class="btn btn-dark more-button">??????</button>
                      </div>
                    </div>
                </div>`);
		this.moviesList.innerHTML = allMoviesList.join("");
	}
	movieLiveSearch(input, showbutton){
		let movieForm = document.querySelector(".movieSearch");
		movieForm.addEventListener("submit", (e)=>e.preventDefault());
		showbutton.addEventListener("click", ()=>{
			let movieText = input.value;
			let foundMovies = this.movies.filter(movie => {
				if (movieText.length<1) return false;
				else if(movieText.length>=3&&(movie.desc.includes(movieText) || movie.name.includes(movieText))) return true;
				else return false;
			});
			if (foundMovies.length>0) {
				this.getMoviesList(foundMovies);
				this.setTotalFound(foundMovies.length);
			}
		});
	}
	setTotalFound(amount){
		// ility = "visibthis.totalFound.style.visible";
		this.totalFound.querySelector("span").textContent = amount;
	}
}

const moviePortal = new MoviePortal();
moviePortal.getMoviesList();

const liveSearch = document.getElementById("liveSearch");
const liveSearchButton = document.getElementById("liveSearchButton");

moviePortal.movieLiveSearch(liveSearch, liveSearchButton);